# This file is generated by script 'example/ci/gitlab/generate.py'
cache: &example_cache
  - paths:
    - example/.venv
    - example/.cargo

example.host.all.test:
  stage: "main"
  script:
    - cd example
    - poetry install
    - poetry run python -u -m example.manage --no-capture --hide-artifacts host.all.test
  artifacts:
    paths:
      - example/target/app
      - example/target/protocol/rust/target
  cache:
    - *example_cache
    - paths:
      - example/target/epics_base_7.0.6.1/host/build
      - example/target/epics_base_7.0.6.1/host/install
      - example/target/epics_base_7.0.6.1/src
      - example/target/rustup

example.mypy:
  stage: "main"
  script:
    - cd example
    - poetry install
    - poetry run mypy -p example
  cache:
    - *example_cache
  allow_failure: true
